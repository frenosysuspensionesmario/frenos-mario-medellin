<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Frenos y Suspensiones Mario | Taller Especializado en Medellín</title>
  <meta name="description" content="Taller especializado en frenos y suspensiones en Medellín. Reparación vehicular, cambio de pastillas, amortiguadores. Servicio honesto y profesional.">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    /* TODOS LOS ESTILOS ANTERIORES PERMANECEN IGUAL */
    /* ... (todo el CSS anterior se mantiene) ... */
    
    /* NUEVOS ESTILOS PARA SISTEMA SEMIAUTOMÁTICO */
    .admin-panel {
      background: #f0f9ff;
      border: 2px dashed #3b82f6;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      display: none; /* Oculto para usuarios normales */
    }
    
    .admin-panel h4 {
      color: #1e40af;
      margin-top: 0;
    }
    
    .export-data {
      background: white;
      padding: 15px;
      border-radius: 8px;
      font-family: monospace;
      white-space: pre-wrap;
      word-wrap: break-word;
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #d1d5db;
    }
    
    .admin-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    
    .admin-btn {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .admin-btn:hover {
      background: #2563eb;
    }
    
    .admin-btn-danger {
      background: #dc2626;
    }
    
    .admin-btn-danger:hover {
      background: #b91c1c;
    }
    
    .testimonios-permanentes {
      background: #f9fafb;
      padding: 25px;
      border-radius: 10px;
      margin: 25px 0;
      border-left: 4px solid #10b981;
    }
    
    .testimonio-item {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border-left: 4px solid #f59e0b;
    }
    
    .testimonio-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .testimonio-cliente {
      font-weight: bold;
      color: #1f2937;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .testimonio-fecha {
      color: #6b7280;
      font-size: 0.9rem;
    }
    
    .testimonio-estrellas {
      color: #f59e0b;
      font-size: 1.2rem;
      margin: 10px 0;
    }
    
    .testimonio-texto {
      line-height: 1.6;
      color: #374151;
      font-style: italic;
      padding: 15px;
      background: #f8fafc;
      border-radius: 6px;
      border-left: 3px solid #d1fae5;
    }
    
    .no-testimonios {
      text-align: center;
      color: #9ca3af;
      font-style: italic;
      padding: 30px;
      background: white;
      border-radius: 8px;
      border: 2px dashed #d1d5db;
    }
    
    /* Mostrar panel admin solo si hay clave especial */
    .admin-visible .admin-panel {
      display: block;
    }
  </style>
  <!-- Iconos de Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

<!-- PORTADA SIMPLIFICADA -->
<header>
  <h1>FRENOS Y SUSPENSIONES MARIO</h1>
  <p class="tagline">Especialistas en Seguridad Vehicular</p>
  <p class="subtitle">Reparación y mantenimiento profesional de frenos y suspensión en Medellín</p>
</header>

<section>

  <!-- ... (todo el contenido anterior igual) ... -->
  <!-- SERVICIOS, CALIFICACIONES REDUCIDAS, CONTADOR DE VISITAS, GALERÍA -->

  <!-- NUEVA SECCIÓN: TESTIMONIOS PERMANENTES VISIBLES PARA TODOS -->
  <div class="testimonios-permanentes">
    <h3><i class="fas fa-comments"></i> Testimonios de Nuestros Clientes</h3>
    <p style="color: #6b7280; margin-bottom: 20px;">Opiniones reales de clientes satisfechos con nuestro servicio</p>
    
    <div id="testimoniosContainer">
      <!-- Testimonios iniciales (puedes agregar manualmente) -->
      <div class="testimonio-item">
        <div class="testimonio-header">
          <div class="testimonio-cliente">
            <i class="fas fa-user-circle"></i> Cliente Satisfecho
          </div>
          <div class="testimonio-fecha">15 de Noviembre, 2024</div>
        </div>
        <div class="testimonio-estrellas">★★★★★</div>
        <div class="testimonio-texto">
          "Excelente servicio, muy profesionales. Repararon los frenos de mi camioneta en tiempo récord y con garantía. Los recomiendo totalmente."
        </div>
      </div>
      
      <div class="testimonio-item">
        <div class="testimonio-header">
          <div class="testimonio-cliente">
            <i class="fas fa-user-circle"></i> Cliente Contento
          </div>
          <div class="testimonio-fecha">10 de Noviembre, 2024</div>
        </div>
        <div class="testimonio-estrellas">★★★★★</div>
        <div class="testimonio-texto">
          "Llevé mi vehículo semipesado para revisión del sistema de aire y quedó perfecto. Atención honesta y precios justos."
        </div>
      </div>
    </div>
    
    <div id="noTestimonios" class="no-testimonios" style="display: none;">
      <i class="fas fa-comment-slash" style="font-size: 2rem; margin-bottom: 10px;"></i>
      <p>Aún no hay testimonios públicos.<br>Sé el primero en compartir tu experiencia.</p>
    </div>
  </div>

  <!-- PANEL DE ADMINISTRACIÓN (OCULTO PARA CLIENTES) -->
  <div class="admin-panel" id="adminPanel">
    <h4><i class="fas fa-user-shield"></i> Panel de Administración de Testimonios</h4>
    <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 15px;">
      Aquí puedes exportar las calificaciones recibidas y agregarlas manualmente a la sección de testimonios públicos.
    </p>
    
    <div class="export-data" id="exportData">
      Esperando calificaciones...
    </div>
    
    <div class="admin-buttons">
      <button class="admin-btn" id="exportRatings">
        <i class="fas fa-download"></i> Exportar Calificaciones
      </button>
      <button class="admin-btn" id="copyToClipboard">
        <i class="fas fa-copy"></i> Copiar al Portapapeles
      </button>
      <button class="admin-btn admin-btn-danger" id="clearAllData">
        <i class="fas fa-trash-alt"></i> Borrar Todas las Calificaciones
      </button>
    </div>
    
    <div style="margin-top: 20px; padding: 15px; background: #fef3c7; border-radius: 8px; border-left: 4px solid #f59e0b;">
      <h5><i class="fas fa-lightbulb"></i> Cómo usar este sistema:</h5>
      <ol style="margin: 10px 0 0 20px; color: #92400e; font-size: 0.9rem;">
        <li>Los clientes califican en la sección superior</li>
        <li>Tú (administrador) haces clic en "Exportar Calificaciones"</li>
        <li>Copias los datos y los agregas manualmente a la sección de testimonios</li>
        <li>Actualizas la página para que todos vean los nuevos testimonios</li>
      </ol>
    </div>
  </div>

  <!-- ... (resto de la página: contacto, mapa, etc.) ... -->

</section>

<footer>
  <p>&copy; 2024 Frenos y Suspensiones Mario - Taller Especializado en Medellín</p>
  <p><small>Servicio profesional de frenos y suspensión para todo tipo de vehículos</small></p>
</footer>

<!-- SCRIPT MEJORADO PARA TESTIMONIOS PÚBLICOS -->
<script>
  // ========== CONTADOR DE VISITAS ==========
  function updateVisitorCounter() {
    let count = localStorage.getItem('pageVisits');
    
    if (count === null) {
      count = 0;
    } else {
      count = parseInt(count);
    }
    
    count = count + 1;
    
    localStorage.setItem('pageVisits', count);
    document.getElementById('visitCount').textContent = count.toLocaleString('es-CO');
    
    console.log('Contador de visitas:', count);
  }
  
  // ========== SISTEMA DE CALIFICACIONES MEJORADO ==========
  let selectedStars = 0;
  let allRatings = [];
  
  // Clave para localStorage
  const RATINGS_KEY = 'frenosMarioRatings';
  const PUBLIC_TESTIMONIALS_KEY = 'frenosMarioTestimoniosPublicos';
  
  // Inicializar estrellas
  document.querySelectorAll('.star').forEach(star => {
    star.addEventListener('mouseover', function() {
      const value = parseInt(this.getAttribute('data-value'));
      highlightStars(value);
    });
    
    star.addEventListener('click', function() {
      selectedStars = parseInt(this.getAttribute('data-value'));
      highlightStars(selectedStars);
    });
  });
  
  // Resaltar estrellas
  function highlightStars(count) {
    document.querySelectorAll('.star').forEach(star => {
      const value = parseInt(star.getAttribute('data-value'));
      if (value <= count) {
        star.classList.add('active');
      } else {
        star.classList.remove('active');
      }
    });
  }
  
  // Guardar nueva calificación
  document.getElementById('submitRating').addEventListener('click', function() {
    if (selectedStars === 0) {
      alert('Por favor, selecciona una calificación con las estrellas antes de enviar.');
      return;
    }
    
    const comment = document.getElementById('commentBox').value.trim();
    const timestamp = new Date().toLocaleString('es-CO');
    const date = new Date().toISOString();
    
    // Crear objeto de calificación
    const newRating = {
      id: Date.now(),
      stars: selectedStars,
      comment: comment,
      timestamp: timestamp,
      date: date,
      status: 'pendiente' // pendiente, aprobado, publicado
    };
    
    // Cargar calificaciones existentes
    loadRatingsFromStorage();
    
    // Agregar nueva calificación
    allRatings.push(newRating);
    
    // Guardar en localStorage
    saveRatingsToStorage();
    
    // Mostrar mensaje de éxito
    document.getElementById('selectedRating').textContent = selectedStars;
    document.getElementById('ratingResult').style.display = 'block';
    
    // Mostrar mensaje informativo
    const mensaje = document.createElement('div');
    mensaje.innerHTML = `
      <div style="margin-top: 15px; padding: 10px; background: #dbeafe; border-radius: 6px; border-left: 3px solid #3b82f6;">
        <i class="fas fa-info-circle"></i> 
        <strong>Gracias por tu calificación:</strong> Tu opinión ha sido registrada. El administrador revisará y publicará los testimonios más destacados.
      </div>
    `;
    document.getElementById('ratingResult').appendChild(mensaje);
    
    // Actualizar estadísticas
    updateRatingStats();
    
    // Resetear formulario
    selectedStars = 0;
    document.querySelectorAll('.star').forEach(star => star.classList.remove('active'));
    document.getElementById('commentBox').value = '';
    document.getElementById('charCount').textContent = '0';
    
    // Mostrar mensaje temporal
    setTimeout(() => {
      document.getElementById('ratingResult').style.display = 'none';
    }, 5000);
    
    console.log('Nueva calificación guardada:', newRating);
  });
  
  // Cargar calificaciones desde localStorage
  function loadRatingsFromStorage() {
    const savedRatings = localStorage.getItem(RATINGS_KEY);
    if (savedRatings) {
      try {
        allRatings = JSON.parse(savedRatings);
        console.log('Calificaciones cargadas:', allRatings.length);
      } catch (e) {
        console.error('Error cargando calificaciones:', e);
        allRatings = [];
      }
    } else {
      allRatings = [];
    }
  }
  
  // Guardar calificaciones en localStorage
  function saveRatingsToStorage() {
    try {
      localStorage.setItem(RATINGS_KEY, JSON.stringify(allRatings));
      console.log('Calificaciones guardadas:', allRatings.length);
    } catch (e) {
      console.error('Error guardando calificaciones:', e);
    }
  }
  
  // Actualizar estadísticas
  function updateRatingStats() {
    if (allRatings.length === 0) {
      document.getElementById('totalRatings').textContent = '0';
      document.getElementById('averageRating').textContent = '0.0';
      document.getElementById('lastRating').textContent = '0';
      return;
    }
    
    const totalStars = allRatings.reduce((sum, rating) => sum + rating.stars, 0);
    const average = totalStars / allRatings.length;
    const lastRating = [...allRatings].sort((a, b) => new Date(b.date) - new Date(a.date))[0];
    
    document.getElementById('totalRatings').textContent = allRatings.length;
    document.getElementById('averageRating').textContent = average.toFixed(1);
    document.getElementById('lastRating').textContent = lastRating.stars;
  }
  
  // ========== SISTEMA DE TESTIMONIOS PÚBLICOS ==========
  
  // Cargar testimonios públicos
  function loadPublicTestimonials() {
    const testimoniosContainer = document.getElementById('testimoniosContainer');
    const noTestimonios = document.getElementById('noTestimonios');
    
    // Por ahora mostramos los testimonios estáticos
    // En una versión avanzada, esto vendría de localStorage o servidor
    
    // Mostrar mensaje si no hay testimonios
    if (testimoniosContainer.children.length === 0) {
      testimoniosContainer.style.display = 'none';
      noTestimonios.style.display = 'block';
    } else {
      testimoniosContainer.style.display = 'block';
      noTestimonios.style.display = 'none';
    }
  }
  
  // ========== PANEL DE ADMINISTRACIÓN ==========
  
  // Verificar si es administrador (clave simple en URL)
  function checkAdminAccess() {
    const urlParams = new URLSearchParams(window.location.search);
    const adminKey = urlParams.get('admin');
    
    if (adminKey === 'frenosmario2024') {
      document.body.classList.add('admin-visible');
      console.log('Modo administrador activado');
    }
  }
  
  // Exportar calificaciones
  document.getElementById('exportRatings')?.addEventListener('click', function() {
    loadRatingsFromStorage();
    
    if (allRatings.length === 0) {
      document.getElementById('exportData').textContent = 'No hay calificaciones para exportar.';
      return;
    }
    
    // Formatear datos para exportación
    let exportText = `=== CALIFICACIONES RECIBIDAS (${allRatings.length}) ===\n\n`;
    
    allRatings.forEach((rating, index) => {
      const stars = '★'.repeat(rating.stars) + '☆'.repeat(5 - rating.stars);
      exportText += `CALIFICACIÓN ${index + 1}:\n`;
      exportText += `Fecha: ${rating.timestamp}\n`;
      exportText += `Estrellas: ${stars} (${rating.stars}/5)\n`;
      exportText += `Comentario: ${rating.comment || 'Sin comentario'}\n`;
      exportText += `Estado: ${rating.status || 'pendiente'}\n`;
      exportText += `ID: ${rating.id}\n`;
      exportText += '─'.repeat(50) + '\n\n';
    });
    
    exportText += `\n=== INSTRUCCIONES ===\n`;
    exportText += `1. Copia los testimonios que quieras publicar\n`;
    exportText += `2. Agrégalos manualmente en la sección de testimonios\n`;
    exportText += `3. Actualiza la página para que todos los vean\n`;
    
    document.getElementById('exportData').textContent = exportText;
  });
  
  // Copiar al portapapeles
  document.getElementById('copyToClipboard')?.addEventListener('click', function() {
    const exportData = document.getElementById('exportData');
    const textToCopy = exportData.textContent;
    
    navigator.clipboard.writeText(textToCopy).then(() => {
      const originalText = this.innerHTML;
      this.innerHTML = '<i class="fas fa-check"></i> Copiado!';
      this.style.background = '#10b981';
      
      setTimeout(() => {
        this.innerHTML = originalText;
        this.style.background = '';
      }, 2000);
    }).catch(err => {
      console.error('Error al copiar:', err);
      alert('Error al copiar al portapapeles. Usa Ctrl+C manualmente.');
    });
  });
  
  // Borrar todas las calificaciones
  document.getElementById('clearAllData')?.addEventListener('click', function() {
    if (confirm('¿ESTÁS SEGURO de borrar TODAS las calificaciones?\nEsta acción NO se puede deshacer.')) {
      localStorage.removeItem(RATINGS_KEY);
      allRatings = [];
      document.getElementById('exportData').textContent = 'Todas las calificaciones han sido borradas.';
      updateRatingStats();
      alert('Todas las calificaciones han sido eliminadas.');
    }
  });
  
  // ========== INICIALIZACIÓN ==========
  document.addEventListener('DOMContentLoaded', function() {
    // Inicializar contador de visitas
    updateVisitorCounter();
    
    // Inicializar contador de caracteres
    const commentBox = document.getElementById('commentBox');
    if (commentBox) {
      commentBox.addEventListener('input', function() {
        document.getElementById('charCount').textContent = this.value.length;
      });
      document.getElementById('charCount').textContent = '0';
    }
    
    // Cargar calificaciones existentes
    loadRatingsFromStorage();
    updateRatingStats();
    
    // Cargar testimonios públicos
    loadPublicTestimonials();
    
    // Verificar acceso de administrador
    checkAdminAccess();
    
    // Efecto hover para estrellas
    document.querySelector('.stars')?.addEventListener('mouseleave', function() {
      highlightStars(selectedStars);
    });
    
    console.log('Página cargada correctamente');
    console.log('Calificaciones totales:', allRatings.length);
  });
</script>

</body>
</html>
